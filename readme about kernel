I used the kernel from TB_8504F_USR_S001011_1810162054_Q12000_ROW_SVC

I couldn't upload the kernel to this repo as it's 29.5 MB so after I synced it I manually dragged the kernel to device/lenovo/tb_8504f then compiled it.
